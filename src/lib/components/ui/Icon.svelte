<script lang="ts">
	import type { SVGAttributes } from 'svelte/elements';
	import {
		GitFork,
		Library,
		Package2,
		Cloud,
		FileCog,
		Ship,
		ShieldAlert,
		Radio,
		Activity,
		RefreshCw,
		FolderGit,
		Puzzle,
		ShipWheel,
		LayoutDashboard,
		LayoutTemplate,
		Bell,
		Layers,
		Network,
		Plus,
		Users,
		Server,
		Key,
		ShieldCheck,
		Shield,
		ArrowRight,
		CheckCircle,
		Link,
		PauseCircle,
		XCircle,
		Search,
		X,
		Sun,
		Moon,
		Monitor,
		Check,
		ChevronRight,
		ChevronLeft,
		Settings,
		Menu,
		Play,
		Pause,
		Loader2,
		GitBranch,
		ChevronDown,
		ChevronUp,
		Save,
		Inbox,
		PackageX,
		UserPlus,
		UserX,
		LogIn,
		ArrowLeft,
		FilterX,
		Trash2,
		FileEdit,
		AlertTriangle,
		HelpCircle,
		RotateCcw,
		CircleOff
	} from 'lucide-svelte';

	interface Props extends SVGAttributes<SVGSVGElement> {
		name: string;
		size?: number | string;
	}

	let { name, size = 24, ...restProps }: Props = $props();

	// Custom/Official icons for specific Flux resources
	const customIcons: Record<
		string,
		{ paths: string[]; viewBox: string; fill?: boolean; stroke?: boolean; strokeWidth?: string }
	> = {
		bucket: {
			// Official Amazon S3 Bucket Path from WorldVectorLogo
			viewBox: '0 0 80 80',
			stroke: true,
			strokeWidth: '2.5',
			paths: [
				'M60.836 42.893l.384-2.704c3.54 2.12 3.587 2.997 3.586 3.02-.006.006-.61.51-3.97-.316zm-1.943-.54C52.773 40.5 44.25 36.59 40.8 34.96c0-.014.004-.027.004-.041a2.406 2.406 0 0 0-2.404-2.403c-1.324 0-2.402 1.078-2.402 2.403s1.078 2.403 2.402 2.403c.582 0 1.11-.217 1.527-.562 4.058 1.92 12.515 5.774 18.68 7.594L56.17 61.56a.955.955 0 0 0-.01.14c0 1.516-6.707 4.299-17.666 4.299-11.075 0-17.853-2.783-17.853-4.298 0-.046-.003-.091-.01-.136l-5.093-37.207c4.409 3.035 13.892 4.64 22.962 4.64 9.056 0 18.523-1.6 22.94-4.625zM15 20.478C15.072 19.162 22.634 14 38.5 14c15.864 0 23.427 5.16 23.5 6.478v.449C61.13 23.877 51.33 27 38.5 27c-12.852 0-22.657-3.132-23.5-6.087zm49 .022c0-3.465-9.934-8.5-25.5-8.5S13 17.035 13 20.5l.094.754 5.548 40.524C18.775 66.31 30.86 68 38.494 68c9.472 0 19.535-2.178 19.665-6.22l2.396-16.896c1.333.319 2.43.482 3.31.482 1.184 0 1.984-.29 2.469-.867a1.95 1.95 0 0 0 .436-1.66c-.26-1.383-1.902-2.875-5.248-4.784l2.376-16.762z'
			]
		},
		kustomize: {
			viewBox: '0 0 24 24',
			fill: true,
			paths: ['M4 4h10v10H4z', 'M10 10h10v10H10z']
		},
		helm: {
			// Official Helm Ship Wheel from CNCF Artwork (Black version)
			viewBox: '0 0 500 500',
			fill: true,
			paths: [
				'M136.52938,121.13478c-.572-.54252-1.19462-1.12636-1.81-1.71761-12.61677-12.12115-22.38092-26.13637-28.279-42.702-1.65073-4.63637-2.89692-9.36515-2.67587-14.35871.021-.4739.01959-.94915.05226-1.42214.445-6.44594,4.75912-9.70322,11.05839-8.17669a27.325,27.325,0,0,1,5.73149,2.19653c6.89022,3.45538,12.5062,8.56359,17.67051,14.16571a112.52651,112.52651,0,0,1,21.722,33.42965,8.29635,8.29635,0,0,0,.38946.861c.07116.12855.22232.21282.55927.51883A176.357,176.357,0,0,1,241.968,79.06864c-.17651-.8761-.28195-1.54571-.44772-2.2a112.49436,112.49436,0,0,1-2.65292-36.95637,84.07478,84.07478,0,0,1,4.44444-21.76378,31.32555,31.32555,0,0,1,5.47651-10.17139,15.687,15.687,0,0,1,3.16336-2.82149,7.026,7.026,0,0,1,8.03255-.056,17.27854,17.27854,0,0,1,5.8402,6.73185A53.05435,53.05435,0,0,1,271.08657,26.508a112.50469,112.50469,0,0,1,2.12263,33.00356,95.59806,95.59806,0,0,1-3.49052,19.91081c7.12171,1.31193,14.20955,2.32869,21.1473,3.97713a186.37909,186.37909,0,0,1,20.44069,6.0033A188.31671,188.31671,0,0,1,331.0769,97.9721c6.34538,3.16433,12.38553,6.94066,18.71757,10.53829.20571-.433.50439-.94982.706-1.50212A108.65959,108.65959,0,0,1,383.40128,60.246a37.75787,37.75787,0,0,1,11.822-6.883,17.24558,17.24558,0,0,1,3.67827-.84512c6.264-.71729,8.89351,3.2244,9.35653,7.93183a29.94372,29.94372,0,0,1-.77381,10.35466A87.90551,87.90551,0,0,1,396.75426,95.492c-6.79016,10.97178-14.85015,20.85494-25.09307,28.83042-.30234.2354-.56784.51814-1.07988.99029a177.77993,177.77993,0,0,1,26.59293,30.88244,10.96227,10.96227,0,0,1-1.689.29762c-10.59546.015-21.1911-.01829-31.78622.04607a4.004,4.004,0,0,1-3.17246-1.69,147.87522,147.87522,0,0,0-88.17776-46.54846,143.35862,143.35862,0,0,0-30.27955-1.16923,146.40735,146.40735,0,0,0-82.53728,31.81054,140.06663,140.06663,0,0,0-16.97616,15.84186,4.72839,4.72839,0,0,1-3.86326,1.75742c-10.12056-.07028-20.24188-.035-30.36293-.03495h-2.15212c.618-2.408,6.84026-10.93786,13.88352-18.55281C125.31349,132.2744,130.87768,126.8839,136.52938,121.13478Z',
				'M394.52934,347.9123a176.63854,176.63854,0,0,1-23.97343,27.16338c.70941.59068,1.28594,1.07041,1.86212,1.55057A108.31456,108.31456,0,0,1,406.10131,424.772a34.61831,34.61831,0,0,1,2.202,14.42026,14.88544,14.88544,0,0,1-.74786,3.69206,7.20762,7.20762,0,0,1-8.15793,5.02308,22.23329,22.23329,0,0,1-6.76276-2.00629,51.23237,51.23237,0,0,1-9.18151-5.8151,107.59183,107.59183,0,0,1-32.936-46.7072c-.18746-.51334-.39218-1.0204-.72243-1.87691a194.65008,194.65008,0,0,1-25.01223,14.00774,181.66925,181.66925,0,0,1-26.6869,9.72442,187.55649,187.55649,0,0,1-28.3045,5.38805c.16807.84015.26446,1.5098.43745,2.15907a109.172,109.172,0,0,1,2.9708,36.44311,80.804,80.804,0,0,1-4.42286,22.4773,78.24971,78.24971,0,0,1-4.16475,8.74473,13.39,13.39,0,0,1-2.33865,2.97083c-3.98009,4.109-8.73225,4.144-12.61157-.07366a27.28012,27.28012,0,0,1-3.907-5.61776c-3.07685-5.77569-4.6604-12.056-5.791-18.46021a116.86329,116.86329,0,0,1-1.35893-26.465,94.4795,94.4795,0,0,1,2.88466-19.18513c.14009-.53269.268-1.0696.37134-1.61034.02629-.13754-.06342-.2973-.17067-.73825a176.12108,176.12108,0,0,1-80.96855-24.99386c-.40992.90921-.76206,1.67473-1.10168,2.44579a110.47729,110.47729,0,0,1-30.90112,41.42041,38.16071,38.16071,0,0,1-12.04706,6.95909,12.08987,12.08987,0,0,1-6.51516.70023,7.11858,7.11858,0,0,1-5.40329-4.4892c-1.41614-3.424-1.16526-6.985-.68438-10.51691a55.45267,55.45267,0,0,1,4.30768-14.25037A112.49985,112.49985,0,0,1,134.88761,380.779c.459-.43461.92981-.857,1.38087-1.29954a3.76029,3.76029,0,0,0,.36534-.65529,178.90466,178.90466,0,0,1-28.469-31.31672c.98458-.08018,1.64327-.18,2.30205-.1806,10.51436-.00976,21.029.02736,31.54284-.04358a4.70554,4.70554,0,0,1,3.70344,1.62615,146.94611,146.94611,0,0,0,39.40276,28.88494,139.94667,139.94667,0,0,0,49.70395,14.77367q70.68048,6.87067,121.59971-42.85452a7.64571,7.64571,0,0,1,5.99261-2.44347c9.80139.12121,19.60512.04986,29.408.04986h2.53353Z'
			]
		},
		flux: {
			// Official FluxCD Logo from Simple Icons/CNCF
			viewBox: '0 0 24 24',
			fill: true,
			paths: [
				'M11.402 23.747c.154.075.306.154.454.238.181.038.37.004.525-.097l.386-.251c-1.242-.831-2.622-1.251-3.998-1.602l2.633 1.712Zm-7.495-5.783a8.088 8.088 0 0 1-.222-.236.696.696 0 0 0 .112 1.075l2.304 1.498c1.019.422 2.085.686 3.134.944 1.636.403 3.2.79 4.554 1.728l.697-.453c-1.541-1.158-3.327-1.602-5.065-2.03-2.039-.503-3.965-.977-5.514-2.526Zm1.414-1.322-.665.432c.023.024.044.049.068.073 1.702 1.702 3.825 2.225 5.877 2.731 1.778.438 3.469.856 4.9 1.982l.682-.444c-1.612-1.357-3.532-1.834-5.395-2.293-2.019-.497-3.926-.969-5.467-2.481Zm7.502 2.084c1.596.412 3.096.904 4.367 2.036l.67-.436c-1.484-1.396-3.266-1.953-5.037-2.403v.803Zm.698-2.337a64.695 64.695 0 0 1-.698-.174v.802l.512.127c2.039.503 3.965.978 5.514 2.526l.007.009.663-.431c-.041-.042-.079-.086-.121-.128-1.702-1.701-3.824-2.225-5.877-2.731Zm-.698-1.928v.816c.624.19 1.255.347 1.879.501 2.039.502 3.965.977 5.513 2.526.077.077.153.157.226.239a.704.704 0 0 0-.238-.911l-3.064-1.992c-.744-.245-1.502-.433-2.251-.618a31.436 31.436 0 0 1-2.065-.561Zm-1.646 3.049c-1.526-.4-2.96-.888-4.185-1.955l-.674.439c1.439 1.326 3.151 1.88 4.859 2.319v-.803Zm0-1.772a8.543 8.543 0 0 1-2.492-1.283l-.686.446c.975.804 2.061 1.293 3.178 1.655v-.818Zm0-1.946a7.59 7.59 0 0 1-.776-.453l-.701.456c.462.337.957.627 1.477.865v-.868Zm3.533.269-1.887-1.226v.581c.614.257 1.244.473 1.887.645Zm5.493-8.863L12.381.112a.705.705 0 0 0-.762 0L3.797 5.198a.698.698 0 0 0 0 1.171l7.38 4.797V7.678a.414.414 0 0 0-.412-.412h-.543a.413.413 0 0 1-.356-.617l1.777-3.079a.412.412 0 0 1 .714 0l1.777 3.079a.413.413 0 0 1-.356.617h-.543a.414.414 0 0 0-.412.412v3.488l7.38-4.797a.7.7 0 0 0 0-1.171Z'
			]
		},
		'sideways-git': {
			viewBox: '0 0 24 24',
			stroke: true,
			paths: ['M6 12h12M15 8l3 4-3 4M8 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0']
		}
	};

	const lucideIcons: Record<string, typeof GitFork> = {
		'git-fork': GitFork,
		'git-branch': GitBranch,
		library: Library,
		package: Package2,
		cloud: Cloud,
		'file-cog': FileCog,
		ship: Ship,
		'shield-alert': ShieldAlert,
		radio: Radio,
		activity: Activity,
		'refresh-cw': RefreshCw,
		'folder-git': FolderGit,
		puzzle: Puzzle,
		'ship-wheel': ShipWheel,
		dashboard: LayoutDashboard,
		'layout-template': LayoutTemplate,
		network: Network,
		plus: Plus,
		users: Users,
		server: Server,
		key: Key,
		'shield-check': ShieldCheck,
		shield: Shield,
		bell: Bell,
		layers: Layers,
		'arrow-right': ArrowRight,
		'check-circle': CheckCircle,
		link: Link,
		'pause-circle': PauseCircle,
		'x-circle': XCircle,
		search: Search,
		x: X,
		sun: Sun,
		moon: Moon,
		monitor: Monitor,
		check: Check,
		'chevron-right': ChevronRight,
		'chevron-left': ChevronLeft,
		settings: Settings,
		menu: Menu,
		play: Play,
		pause: Pause,
		loader: Loader2,
		'chevron-down': ChevronDown,
		'chevron-up': ChevronUp,
		save: Save,
		inbox: Inbox,
		'package-x': PackageX,
		'user-plus': UserPlus,
		'user-x': UserX,
		'log-in': LogIn,
		'arrow-left': ArrowLeft,
		'filter-x': FilterX,
		'trash-2': Trash2,
		'file-edit': FileEdit,
		'alert-triangle': AlertTriangle,
		'help-circle': HelpCircle,
		'rerotate-ccw': RotateCcw,
		'circle-off': CircleOff,

		// Resource Kind mappings (lowercase)
		gitrepository: GitBranch,
		helmrepository: Library,
		kustomization: FileCog,
		helmrelease: Ship
	};

	const IconComponent = $derived(lucideIcons[name]);
	const customIcon = $derived(customIcons[name]);
</script>

{#if customIcon}
	<svg
		xmlns="http://www.w3.org/2000/svg"
		width={size}
		height={size}
		viewBox={customIcon.viewBox}
		fill={customIcon.fill ? 'currentColor' : 'none'}
		stroke={customIcon.stroke ? 'currentColor' : 'none'}
		stroke-width={customIcon.stroke ? customIcon.strokeWidth || '2' : '0'}
		stroke-linecap="round"
		stroke-linejoin="round"
		{...restProps}
	>
		{#each customIcon.paths as path, i (i)}
			<path d={path} />
		{/each}
	</svg>
{:else if IconComponent}
	<IconComponent {size} {...restProps as Record<string, unknown>} />
{/if}
